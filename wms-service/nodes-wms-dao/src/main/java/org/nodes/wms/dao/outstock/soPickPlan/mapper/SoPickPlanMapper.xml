<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.nodes.wms.dao.outstock.soPickPlan.mapper.SoPickPlanMapper">


    <select id="selectSoPickPlanBySoBillIdAndSoDetailId"
            resultType="org.nodes.wms.dao.outstock.soPickPlan.dto.output.SoPickPlanForDistributionResponse">
        SELECT
        pick_plan_id,
        box_code,
        zone_id,
        zone_code,
        loc_id,
        loc_code,
        lpn_code,
        pick_plan_qty,
        pick_real_qty,
        sku_code,
        sku_id,
        sku_name,
        lot_number,
        stock_status,
        sku_lot1, sku_lot2, sku_lot3,
        sku_lot4, sku_lot5, sku_lot6,
        sku_lot7, sku_lot8, sku_lot9,
        sku_lot10,sku_lot11, sku_lot12,
        sku_lot13,sku_lot14, sku_lot15,
        sku_lot16,sku_lot17, sku_lot18,
        sku_lot19,sku_lot20, sku_lot21,
        sku_lot21,sku_lot23, sku_lot24,
        sku_lot25,sku_lot26, sku_lot27,
        sku_lot28,sku_lot29, sku_lot30
        FROM so_pick_plan
        <where>
            is_deleted = 0
            AND pick_plan_qty > pick_real_qty
            AND so_bill_id = #{soBillId}
            <if test="soDetailId != null and soDetailId != ''">
                AND so_detail_id = #{soDetailId}
            </if>
        </where>
        ORDER BY box_code,zone_code,loc_code,lpn_code
    </select>
</mapper>
